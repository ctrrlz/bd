create database sytko16
use sytko16

CREATE TABLE test1 (
Id INTEGER NOT NULL IDENTITY(1, 1),
[SecondId] INTEGER NULL,
Name VARCHAR(255) NULL,
Num Decimal (6,1) NULL,
Date Date Null,
PRIMARY KEY (Id)
);
GO

INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(1,'Fay Ashley',41.1,'26.04.22'),
(2,'Venus Waters',26.1,'17.08.21'),
(3,'Wanda Wall',9.1,'20.09.21'),
(4,'Tiger Gillespie',82.1,'23.04.21'),
(5,'Felicia Miller',83.1,'14.07.21'),
(6,'Leroy Simon',27.1,'25.05.21'),
(7,'Vivien Knox',16.1,'20.01.22'),
(8,'Rhiannon Hanson',5.1,'13.05.21'),
(9,'Riley Hull',39.1,'25.12.22'),
(10,'Angelica Keller',78.1,'23.04.21');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(11,'MacKenzie Maldonado',43.1,'14.05.22'),
(12,'Tyler Hall',18.1,'08.06.21'),
(13,'Stacey Reeves',57.1,'30.03.21'),
(14,'Beau Bullock',5.1,'05.02.23'),
(15,'Lillian Burris',30.1,'27.08.21'),
(16,'Elijah Thompson',41.1,'11.11.21'),
(17,'Oliver Russell',49.1,'01.04.22'),
(18,'Hoyt Lang',13.1,'31.10.21'),
(19,'Yuli Cortez',89.1,'04.12.21'),
(20,'Rudyard Ballard',0.1,'16.06.22');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(21,'Cade Irwin',33.1,'07.10.22'),
(22,'Walker Beck',57.1,'27.04.21'),
(23,'Meredith Barron',49.1,'15.03.21'),
(24,'Jasmine Nunez',60.1,'03.12.21'),
(25,'Bell Terry',99.1,'06.05.21'),
(26,'Kiayada Kennedy',8.1,'04.10.22'),
(27,'Margaret Shepherd',13.1,'23.01.22'),
(28,'Sybil Blackwell',29.1,'11.09.22'),
(29,'Nehru Lawrence',63.1,'24.05.21'),
(30,'Honorato Lee',49.1,'07.04.22');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(31,'Brendan William',7.1,'09.10.21'),
(32,'Jonah Cobb',96.1,'05.04.21'),
(33,'Len Butler',33.1,'22.10.22'),
(34,'Brittany Holcomb',36.1,'06.08.22'),
(35,'Hu Santiago',1.1,'11.11.21'),
(36,'Denise Horne',77.1,'06.06.22'),
(37,'Flynn West',54.1,'04.03.21'),
(38,'Wang Wilkerson',17.1,'07.06.22'),
(39,'Mercedes Melendez',24.1,'09.11.21'),
(40,'Reagan Dawson',45.1,'19.10.21');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(41,'Ingrid Ferguson',43.1,'21.03.21'),
(42,'Barry Howell',20.1,'22.03.22'),
(43,'Raja Robles',78.1,'27.05.21'),
(44,'Justina Jordan',13.1,'10.12.21'),
(45,'William Copeland',57.1,'31.07.21'),
(46,'Halee Buck',79.1,'11.12.21'),
(47,'Quinn Parker',27.1,'14.11.22'),
(48,'Gavin England',13.1,'03.11.22'),
(49,'Hillary Monroe',41.1,'01.03.22'),
(50,'Kyla Combs',5.1,'16.11.21');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(51,'Savannah Atkinson',23.1,'26.09.21'),
(52,'Dorothy Hernandez',62.1,'07.03.21'),
(53,'Laurel Riddle',27.1,'15.09.21'),
(54,'Acton Petersen',31.1,'14.07.22'),
(55,'Branden Pena',11.1,'16.05.21'),
(56,'Guy Simon',33.1,'24.03.22'),
(57,'Kermit Tate',17.1,'02.08.22'),
(58,'Clare Solomon',20.1,'22.08.21'),
(59,'Yvonne Patterson',50.1,'16.07.22'),
(60,'Jesse Richards',60.1,'28.08.22');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(61,'Veronica Odom',12.1,'19.06.21'),
(62,'Gage Terrell',33.1,'20.02.21'),
(63,'Kane Duran',77.1,'25.01.23'),
(64,'Zelda Austin',6.1,'13.08.22'),
(65,'Sasha Preston',96.1,'29.12.21'),
(66,'Matthew Terry',26.1,'05.04.22'),
(67,'Kennedy Mckee',82.1,'17.11.22'),
(68,'Celeste Christensen',88.1,'03.11.22'),
(69,'Angela Wilcox',42.1,'17.04.22'),
(70,'Irma Wong',3.1,'18.02.22');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(71,'Jolene Hart',92.1,'21.01.23'),
(72,'Leslie Reese',28.1,'11.06.22'),
(73,'Adara Dominguez',90.1,'09.05.22'),
(74,'Orlando Fernandez',98.1,'18.01.23'),
(75,'Solomon Bright',99.1,'29.09.22'),
(76,'Ramona Patrick',52.1,'10.11.21'),
(77,'Lucius Gilbert',38.1,'24.09.21'),
(78,'Ocean Joyner',17.1,'09.11.22'),
(79,'Gannon Bates',90.1,'20.10.21'),
(80,'Griffin Evans',56.1,'08.12.21');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(81,'Simon Joyce',84.1,'20.07.22'),
(82,'Jonas Bowman',99.1,'15.08.21'),
(83,'Myles Price',37.1,'31.12.22'),
(84,'Dante Cox',23.1,'14.06.21'),
(85,'Alika Barker',68.1,'20.09.21'),
(86,'Petra Tran',9.1,'23.10.21'),
(87,'Ishmael Fisher',33.1,'02.01.22'),
(88,'Kirk Lamb',20.1,'25.02.22'),
(89,'Leah
Jacobson',32.1,'19.07.21'),
(90,'Maxine Little',72.1,'15.06.21');
INSERT INTO test1 (secondId,Name,Num,Date)
VALUES
(91,'Benjamin Reynolds',61.1,'23.12.21'),
(92,'Cody Bond',20.1,'14.01.22'),
(93,'Olympia Nunez',77.1,'07.02.22'),
(94,'Ray Case',87.1,'16.08.22'),
(95,'Brian Bird',69.1,'19.02.22'),
(96,'Griffith Hardy',41.1,'13.12.21'),
(97,'Jasmine Sexton',73.1,'21.04.21'),
(98,'Hiram Irwin',58.1,'02.09.21'),
(99,'Jael Jordan',87.1,'02.09.22'),
(100,'Miriam Nunez',2.1,'23.10.21');

select * from test1

Чфункции

Select @@IDENTITY from test1

delete test1
Select @@ROWCOUNT

Чпреобразвание
Select Num/3,
Cast(Num as int)/3,
convert (nvarchar(20),Num)
from test1

Чстроковые функции
Select Ascii (Name)[Ascii],
Unicode (Name) [Unicode]
from test1

Select char(Cast (Num as int )) [char],
Nchar (Cast(Num As int)+1000 ) [Unicode]
from test1

Select Left(Name,2) [Left],
Right(Name,2) [Right],
Lower(Name) [Lower],
upper(Name)[upper],
Len(Name),
Reverse(Name) [Reverse]
from test1

Ч замена (нашел 5 символ и удалил 1 символ (Substring -выделение))
Select Stuff(Name,5,1,'!!!!') [Stuff],
Substring(Name,1,2)[Substring]
from test1

Чматематические
Select
Num ,Sqrt(Num),square(Num),Power(Num,3),
FLOOR(Num),--до наименьшего
Round(Num,1), Ч округление по правилам математики
rand(Num)
from test1
Чдата и врем€
Select GETDATE() Чтекущее врем€ и дата

Select Date from test1
Where Datepart(Month,Date) = 12

select
Datename(Month,Date),
Datename(Quarter,Date),
Day(Date),
Month(Date),
Year(Date)
from test1

Чагрегатные
create table test2(
Id int identity,
Date date not null,
Productime int,
Qty int,
Price Decimal(6,4),
City nvarchar(50)
)
Set Dateformat DMY
Insert test2
values
('17-01-2020',1,2,12.4,'Minsk'),
('17-01-2020',2,5,12.2,'Brest'),
('18-01-2020',1,3,10.2,Null),
('18-01-2020',3,1,11.8,'Vitebsk'),
('18-01-2020',1,7,11.6,'Minsk'),
('18-01-2020',4,1,8.7,'Mogilev'),
('19-01-2020',3,8,13.1,Null),
('19-01-2020',2,2,18.1,'Brest'),
('19-01-2020',2,7,4.3,'Grodno'),
('20-01-2020',1,8,5.1,'Vitebsk'),
('21-01-2020',1,9,13.6,'Grodno'),
('21-01-2020',3,9,13.7,Null)

Чsum
select sum (Qty)as[кол-во товара] from test2

select Productime, sum(Qty) from test2
where city is not null
group by Productime
having sum(Qty)>10

Чmin max
select Productime ,Min (Price),Max(Price) from test2
where city is not null
group by Productime

Чavg()-среднее значение
select Productime ,Min (Price),Max(Price),Avg(Price) from test2
where city is not null
group by Productime

Ч4 count()--подсчет кол-ва
select count(*) from test2
select count(city) from test2


Чподсчитать кол-во неповтор€ющихс€
select count (distinct city) from test2

Чподзапросы
create table test4(
Id1 int,
Name nvarchar(50)
)
create table test5(
Id2 int,
Name nvarchar(50)
)

insert test4
values
(1,'один'),
(2,'два'),
(3,'три'),
(4,'четыре'),
(5,'п€ть'),
(9,'дев€ть'),
(10,'дес€ть')

insert test5
values
(1,'один'),
(2,'два'),
(3,'три'),
(4,'четыре'),
(5,'п€ть'),
(6,'шесть'),
(7,'семь'),
(8,'восемь')

select Id1 ,t4.Name from test4 t4,test5 t5
where t4.Id1 = Id2

Чподзапросы
select * from test4
where Id1=(select Id2 from test5 where Id2 = 1)